package de.grammarcraft.xtend.annotatedflow

import de.grammarcraft.xtend.flow.annotations.FunctionUnit
import de.grammarcraft.xtend.flow.annotations.InputPort
import de.grammarcraft.xtend.flow.annotations.OutputPort

@FunctionUnit(
    inputPorts = #[
        @InputPort(name="input", type=String)
    ],
    outputPorts = #[
        @OutputPort(name="lower", type=String),
        @OutputPort(name="upper", type=String)
    ]
)
class Normalize {
    
    val toLower = new ToLower
    val toUpper = new ToUpper
    
    new() { 
        toLower.output -> lower
        toUpper.output -> upper
    }

    override processInput(String msg) {
        toLower <= msg // input value forwarding
        toUpper <= [ // input value forwarding by result of a closure
            if (msg.length > 3) // meaningless! only to show arbitrary code may be specified here
                msg
            else 
                msg
        ]
    }
    
    /**
     * {@inheritDoc} 
     * Note: Will later be automatically generated by the FunctionUnit annotation for function units with only one input port. 
     * Here added only for exploring Xtend's embedded DSL design capabilities
     */
    override <= (String msg) {
        input <= msg
    }
    
    /**
     * {@inheritDoc} 
     * Note: Will later be automatically generated by the FunctionUnit annotation for function units with only one input port. 
     * Here added only for exploring Xtend's embedded DSL design capabilities
     */
    override <= (()=>String msgClosure) {
        input <= msgClosure.apply
    }
    
}